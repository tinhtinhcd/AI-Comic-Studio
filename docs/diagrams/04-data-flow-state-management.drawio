<mxfile host="app.diagrams.net" modified="2025-02-10T21:34:00.000Z" agent="5.0" etag="your-etag" version="21.1.2" type="device">
  <diagram name="Data Flow & State Management" id="data-flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- ComicProject State -->
        <mxCell id="comic-project-state" value="ComicProject State" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#01579b;fontSize=16;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="1080" height="160" as="geometry" />
        </mxCell>
        
        <mxCell id="state-properties" value="title: string&lt;br/&gt;theme: string&lt;br/&gt;characters: Character[]&lt;br/&gt;panels: ComicPanel[]&lt;br/&gt;workflowStage: Workflow&lt;br/&gt;currentChapter: number&lt;br/&gt;targetLanguages: string[]&lt;br/&gt;agentTasks: AgentTask[]&lt;br/&gt;logs: SystemLog[]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="60" y="80" width="1040" height="100" as="geometry" />
        </mxCell>
        
        <!-- State Update Flow -->
        <mxCell id="state-update-flow" value="State Update Flow" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e8;strokeColor=#2e7d32;fontSize=16;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="40" y="240" width="1080" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="user-action" value="User Action" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="80" y="280" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="agent-workspace" value="Agent Workspace" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="280" y="280" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="state-update" value="State Update" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="480" y="280" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="ui-render" value="UI Render" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="680" y="280" width="140" height="60" as="geometry" />
        </mxCell>
        
        <!-- Flow Details -->
        <mxCell id="form-input" value="Form Input&lt;br/&gt;Selection" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="350" width="140" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="agent-logic" value="Agent Logic&lt;br/&gt;AI Service" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="280" y="350" width="140" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="immutable-update" value="Immutable&lt;br/&gt;Update" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="480" y="350" width="140" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="react-rerender" value="React&lt;br/&gt;Re-render" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="680" y="350" width="140" height="20" as="geometry" />
        </mxCell>
        
        <!-- Persistence Strategy -->
        <mxCell id="persistence-strategy" value="Persistence Strategy" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#7b1fa2;fontSize=16;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="40" y="400" width="1080" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="cloud-storage" value="Primary:&lt;br/&gt;Neon Postgres (Cloud)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1976d2;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="80" y="440" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="local-storage" value="Fallback:&lt;br/&gt;IndexedDB (Local)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e8f5e8;strokeColor=#2e7d32;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="300" y="440" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="cache" value="Cache:&lt;br/&gt;localStorage (Settings/Auth)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="520" y="440" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="backup" value="Backup:&lt;br/&gt;JSZip Export/Import" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#c2185b;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="740" y="440" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- Connections -->
        <mxCell id="edge1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="comic-project-state" target="state-update-flow">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="user-action" target="agent-workspace">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="agent-workspace" target="state-update">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="state-update" target="ui-render">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="state-update-flow" target="persistence-strategy">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="state-update" target="cloud-storage">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="state-update" target="local-storage">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="state-update" target="cache">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="state-update" target="backup">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- Cycle Arrow -->
        <mxCell id="cycle-arrow" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;dashed=1;dashPattern=5 5;" edge="1" parent="1" source="ui-render" target="user-action">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
